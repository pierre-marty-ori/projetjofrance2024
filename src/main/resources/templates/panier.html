<div th:insert="~{fragments/header :: header}"></div>
<div th:insert="~{fragments/navbar :: navbar}"></div>

<div class="container my-4">
    <h1 class="text-center" th:text="${title}"></h1>

    <div th:if="${#lists.isEmpty(articles)}">
        <p class="text-center my-3">Votre panier est vide.</p>
    </div>

    <div th:if="${not #lists.isEmpty(articles)}">

        <div sec:authorize="isAnonymous()" class="m-5">
            <div class="alert alert-info" role="alert">
                Vous devez <a th:href="@{/user/login}">vous connecter</a> pour valider votre commande.
                Si vous n'avez pas de compte, vous devez en créer un. <a th:href="@{/user/register}">Créer un compte</a>.
            </div>
        </div>

        <div class="d-flex justify-content-between m-5" th:each="article : ${articles}">
            <p th:text="${article.nom}"></p>
            <p th:text="${article.price} + ' €'"></p>
            <form th:action="@{/panier/supprimer/{id}(id=${article.id})}" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}" />
                <button type="submit" class="btn btn-md btn-danger p-2">
                    <i class="fas fa-trash"></i>
                </button>
            </form>
        </div>

        <div sec:authorize="isAuthenticated()" class="d-flex justify-content-center">
            <form action="/panier/valider" method="post">
                <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
                <button type="submit" class="btn btn-success">Valider la commande</button>
            </form>
        </div>

    </div>

</div>

<div th:insert="~{fragments/footer :: footer}"></div>